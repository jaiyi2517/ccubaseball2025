<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è–èª•æ£’çƒæ´¾å°æŠ½ç±¤æ©Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&family=Noto+Serif+TC:wght@700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        /* --- KTV å°ˆç”¨é«˜å°æ¯”é…è‰² --- */
        :root {
            --neon-gold: #FFD700;
            --neon-red: #FF3333;
            --bright-white: #FFFFFF;
            --deep-bg: #050505;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--deep-bg);
            color: var(--bright-white);
            overflow: hidden; /* é˜²æ­¢æ²å‹• */
            font-weight: 700;
            touch-action: manipulation; /* å„ªåŒ–è§¸æ§ */
        }

        h1, h2, h3, .serif-title {
            font-family: 'Noto Serif TC', serif;
            font-weight: 900;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }
        
        .eng-font {
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 0.1em;
        }

        /* èƒŒæ™¯å‹•æ…‹æ°›åœç‡ˆ */
        .ambient-light {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 30%, rgba(255, 50, 50, 0.15), rgba(0,0,0,0) 70%);
            z-index: 0; pointer-events: none;
            animation: pulseLight 5s infinite alternate;
        }
        @keyframes pulseLight {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* --- å°èˆªåˆ— --- */
        nav {
            position: fixed; top: 0; left: 0; width: 100%; height: 80px;
            z-index: 100;
            background: linear-gradient(to bottom, rgba(0,0,0,1) 60%, rgba(0,0,0,0) 100%);
            display: flex; justify-content: center; align-items: center;
            padding-top: 10px; /* å¢åŠ ä¸€é»é ‚éƒ¨ç©ºé–“ */
        }
        
        .nav-btn {
            background: rgba(255,255,255,0.1);
            color: #888;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 6px 14px;
            margin: 0 4px;
            border-radius: 50px;
            font-size: 0.95rem;
            backdrop-filter: blur(5px);
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            display: flex; align-items: center; gap: 6px;
            cursor: pointer;
            white-space: nowrap;
        }
        .nav-btn span {
            font-size: 1.2em;
        }
        .nav-btn.active {
            background: var(--neon-gold);
            color: #000;
            border-color: var(--neon-gold);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            font-weight: 900;
        }
        /* é›»è…¦ç‰ˆå¾®èª¿ */
        @media (min-width: 768px) {
            .nav-btn {
                padding: 8px 24px;
                margin: 0 8px;
                font-size: 1.1rem;
                gap: 8px;
            }
        }

        /* --- é é¢å®¹å™¨ (RWD èª¿æ•´é‡é») --- */
        .page-section {
            position: absolute; top: 0; left: 0; width: 100%; 
            /* ä½¿ç”¨ dvh (Dynamic Viewport Height) ä»¥é©æ‡‰æ‰‹æ©Ÿç€è¦½å™¨ç¶²å€åˆ— */
            height: 100vh;
            height: 100dvh; 
            display: flex; flex-direction: column; 
            /* æ‰‹æ©Ÿç‰ˆä½¿ç”¨ flex-start è®“å…§å®¹å¾ä¸Šå¾€ä¸‹æ’ï¼Œé¿å…è¢«æ“ åˆ°æœ€åº• */
            justify-content: flex-start; 
            align-items: center;
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
            transform: scale(0.95); z-index: 10;
            
            /* èª¿æ•´ padding */
            padding-top: 90px; /* ç•™å‡ºå°èˆªåˆ—ç©ºé–“ */
            padding-bottom: 80px; /* åº•éƒ¨ç•™ç™½ï¼Œç¢ºä¿æ²å‹•ç©ºé–“ */
            overflow-y: auto; /* å…è¨±å‚ç›´æ²å‹•ä»¥é˜²å…§å®¹éé•· */
        }
        
        /* é›»è…¦ç‰ˆç¶­æŒç½®ä¸­ */
        @media (min-width: 768px) {
            .page-section {
                justify-content: center;
                padding-top: 60px;
                padding-bottom: 20px;
                overflow-y: hidden;
            }
        }

        .page-section.active {
            opacity: 1; visibility: visible; pointer-events: auto;
            transform: scale(1); z-index: 20;
        }

        /* --- THEME 1: æ£’çƒè½‰è›‹ --- */
        .gacha-sphere {
            width: min(75vw, 300px); 
            height: min(75vw, 300px);
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
            border: 4px solid rgba(255,255,255,0.3);
            box-shadow: inset 0 0 50px #000, 0 0 30px rgba(255, 255, 255, 0.1);
            position: relative; overflow: hidden; 
            margin-bottom: 20px; /* æ‰‹æ©Ÿç‰ˆæ¸›å°‘ä¸‹æ–¹é–“è· */
        }
        @media (min-width: 768px) {
            .gacha-sphere {
                margin-bottom: 40px;
            }
        }
        
        #gachaCanvas {
            width: 100%;
            height: 100%;
        }

        /* æŠ½é¸æ™‚çš„æ»¾å‹•å‹•ç•«å±¤ */
        .rolling-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.2s;
            z-index: 50;
        }
        .rolling-overlay.active { opacity: 1; }
        
        .rolling-ball {
            width: 50%; height: 50%; /* ç›¸å°å°ºå¯¸ */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='48' fill='white' stroke='%23999' stroke-width='1'/%3E%3Cpath d='M30 15 Q 55 50 30 85' fill='none' stroke='%23d00' stroke-width='4' stroke-dasharray='5 3' stroke-linecap='round'/%3E%3Cpath d='M70 15 Q 45 50 70 85' fill='none' stroke='%23d00' stroke-width='4' stroke-dasharray='5 3' stroke-linecap='round'/%3E%3C/svg%3E");
            background-size: cover;
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(255,255,255,0.5);
        }
        .rolling-overlay.active .rolling-ball {
            animation: spinBall 0.4s linear infinite;
        }
        @keyframes spinBall {
            0% { transform: rotate(0deg) scale(0.9); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(0.9); }
        }
        
        .action-btn {
            font-size: clamp(1.2rem, 5vw, 1.5rem); 
            font-weight: 900;
            padding: 12px 40px;
            border-radius: 50px;
            background: var(--neon-gold);
            color: #000;
            border: none;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            transform: scale(1);
            transition: transform 0.1s;
            cursor: pointer;
            z-index: 50;
            white-space: nowrap;
            
            /* ä¿®æ”¹ï¼šç§»é™¤ margin-top: autoï¼Œæ”¹ç‚ºå›ºå®šé–“è· */
            margin-top: 20px; 
            margin-bottom: 20px; 
        }
        @media (min-width: 768px) {
            .action-btn {
                margin-top: 0;
                margin-bottom: 0;
            }
        }

        .action-btn:active { transform: scale(0.95); }
        .action-btn:disabled { opacity: 0.7; cursor: not-allowed; transform: scale(1); }

        .result-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 200;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .result-overlay.show { opacity: 1; pointer-events: auto; }
        
        .result-content {
            text-align: center; width: 90%; max-width: 500px;
            transform: scale(0.8); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .result-overlay.show .result-content { transform: scale(1); }

        .result-text {
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            line-height: 1.4;
            color: var(--neon-gold);
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
            margin-bottom: 2rem;
            border-top: 2px solid #555;
            border-bottom: 2px solid #555;
            padding: 2rem 0;
            background: rgba(255,255,255,0.05);
        }

        /* --- THEME 2: éœ“è™¹è¨˜åˆ†æ¿ --- */
        .scoreboard-container {
            width: 90%; max-width: 500px;
            background: #1a1a1a;
            border: 4px solid #444;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 0 50px rgba(255, 50, 50, 0.2);
            margin-bottom: 20px; /* ç¸®å°é–“è· */
        }
        .scoreboard-screen {
            background: #000;
            height: clamp(100px, 15vh, 140px); /* ç¨å¾®ç¸®å°é«˜åº¦ */
            border: 2px solid #333;
            border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
            position: relative;
        }
        .scoreboard-screen::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }
        
        .slot-text {
            font-size: clamp(2.5rem, 10vw, 3.5rem);
            font-family: 'Bebas Neue', 'Noto Sans TC', sans-serif;
            color: var(--neon-red);
            text-shadow: 0 0 15px var(--neon-red);
            white-space: nowrap;
        }
        .slot-text.blur {
            filter: blur(4px);
            transform: scaleY(1.2);
            opacity: 0.8;
            color: #fff;
        }

        /* --- THEME 3: æ’•å¡åŒ… (åˆ†é›¢å¼è¨­è¨ˆ) --- */
        .pack-scene {
            /* ä¿®æ”¹ï¼šç˜¦é•·å‹å°å°ºå¯¸å¡ç‰‡ï¼Œé«˜åº¦è¨­å®šç‚º 220px (å¡ç‰‡ç´„ 200px) */
            width: min(75vw, 250px); 
            height: 330px;
            position: relative;
            cursor: pointer;
            margin-bottom: 15px; /* ç¸®å°èˆ‡æŒ‰éˆ•çš„è·é›¢ */
            z-index: 30; 
            flex-shrink: 0; /* é˜²æ­¢æ“ å£“ */
        }

        /* çƒå“¡å¡ - è³ªæ„Ÿå„ªåŒ– */
        .player-card {
            position: absolute; 
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            background: linear-gradient(135deg, #ffffff 0%, #f0f2f5 50%, #e1e4e8 100%);
            border-radius: 8px;
            z-index: 10; 
            transform: translateY(0);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 4px solid var(--neon-gold);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2), inset 0 0 20px rgba(255, 255, 255, 0.8);
            overflow: hidden;
            color: #1a202c; 
            transition: transform 0.5s ease;
        }

        /* è¢‹èº« */
        .pack-body {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 85%;
            background: linear-gradient(135deg, #bdc3c7 0%, #ffffff 50%, #a8a8a8 100%);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            z-index: 20; 
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.4);
            border-top: none;
            color: #2c3e50;
            clip-path: polygon(
                0% 5%, 5% 0%, 10% 5%, 15% 0%, 20% 5%, 25% 0%, 30% 5%, 35% 0%, 40% 5%, 45% 0%, 
                50% 5%, 55% 0%, 60% 5%, 65% 0%, 70% 5%, 75% 0%, 80% 5%, 85% 0%, 90% 5%, 95% 0%, 100% 5%, 
                100% 100%, 0% 100%
            );
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        /* å°å£ */
        .pack-cap {
            position: absolute; top: 0; left: 0; width: 100%; height: 16%; 
            background: linear-gradient(135deg, #a8a8a8 0%, #ffffff 50%, #bdc3c7 100%);
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            z-index: 21;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.4);
            border-bottom: none;
            clip-path: polygon(
                0% 0%, 100% 0%, 100% 80%, 
                95% 100%, 90% 80%, 85% 100%, 80% 80%, 75% 100%, 70% 80%, 65% 100%, 60% 80%, 55% 100%, 50% 80%, 
                45% 100%, 40% 80%, 35% 100%, 30% 80%, 25% 100%, 20% 80%, 15% 100%, 10% 80%, 5% 100%, 0% 80%
            );
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .pack-body::before, .pack-cap::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.8) 50%, transparent 60%);
            background-size: 200% 200%;
            animation: foilShine 3s infinite;
            pointer-events: none;
        }
        @keyframes foilShine { 0% {background-position: 100% 100%;} 100% {background-position: -100% -100%;} }

        /* --- é–‹å•Ÿæ™‚çš„å‹•ç•«ç‹€æ…‹ --- */
        .pack-scene.opened .pack-cap {
            transform: translateY(-80px) rotate(-15deg) scale(0.9);
            opacity: 0;
            pointer-events: none;
            transition: transform 0.6s ease-out, opacity 0.6s ease;
        }
        
        .pack-scene.opened .player-card {
            /* ä¿®æ­£ï¼šå¡ç‰‡æ”¾å¤§ï¼Œä¸”ä¸æœƒæ“ å£“ä¸Šæ–¹ç©ºé–“ */
            transform: scale(1.05); 
            z-index: 25; 
            transition: transform 1.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .pack-scene.opened .pack-body {
            /* åŒ…è£å¤§å¹…å‘ä¸‹æ»‘è½ */
            transform: translateY(250px); 
            opacity: 0;
            pointer-events: none; 
            transition: transform 1s ease-in 0.8s, opacity 0.8s ease 1s;
        }

        .card-name {
            font-size: clamp(2.5rem, 8vw, 3.5rem); 
            color: #000;
            writing-mode: vertical-rl;
            text-orientation: upright;
            font-family: 'Noto Serif TC', serif;
            font-weight: 900;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.2s ease;
            
            /* æ–°å¢ï¼šå­—é–“è·è¨­å®š */
            letter-spacing: 0.2em; 
        }
        .pack-scene.opened .card-name {
            opacity: 1; transform: scale(1);
            transition: all 1s ease 2.2s; 
        }
        
        /* ä¿®æ”¹ï¼šæŒ‰éˆ•æ¨£å¼æ”¹ç‚ºçµ•å°å®šä½ï¼Œé¿å…æ“ å£“å¡ç‰‡ï¼Œå›ºå®šæ–¼åº•éƒ¨ */
        .reset-btn {
            position: absolute; 
            bottom: 30px; /* è·é›¢å®¹å™¨åº•éƒ¨çš„ä½ç½® */
            left: 50%;
            transform: translateX(-50%);
            z-index: 100; 
            background: #fff;
            color: #000;
            border: none;
            padding: 10px 30px;
            border-radius: 50px;
            font-weight: 900;
            font-size: 1rem;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
            opacity: 0;
            pointer-events: auto; 
            transition: opacity 0.5s ease, transform 0.1s ease;
            display: none;
            cursor: pointer;
            white-space: nowrap;
        }
        .reset-btn:hover {
            transform: translateX(-50%) scale(1.05); /* ä¿®æ­£ hover æ™‚çš„è®Šå½¢ï¼Œä¿ç•™ translateX */
            box-shadow: 0 0 30px rgba(255,255,255,0.8);
        }

    </style>
</head>
<body>

    <div class="ambient-light"></div>

    <!-- å°èˆªåˆ— (æ›´æ–°æ¨™é¡Œèˆ‡åœ–ç¤º) -->
    <nav>
        <button onclick="switchTab(1)" id="btn-tab1" class="nav-btn active">
            <span>ğŸ</span> ç‹ç‰Œçƒæ¢
        </button>
        <button onclick="switchTab(2)" id="btn-tab2" class="nav-btn">
            <span>ğŸ°</span> å¹¸é‹å°éšŠ
        </button>
        <button onclick="switchTab(3)" id="btn-tab3" class="nav-btn">
            <span>ğŸ…</span> å¤©é¸ä¹‹äºº
        </button>
    </nav>

    <!-- é é¢ 1: æ£’çƒè½‰è›‹ -->
    <section id="theme1" class="page-section active">
        <div class="mb-4 text-center">
            <h2 class="text-3xl md:text-4xl serif-title text-white tracking-widest"><span class="text-yellow-500">LUCKY</span> PITCH</h2>
            <p class="text-gray-400 text-xs md:text-sm mt-1 font-bold">é»æ“ŠæŒ‰éˆ• æŠ•å‡ºå‘½é‹çš„ä¸€çƒ</p>
        </div>

        <div class="gacha-sphere flex items-center justify-center">
            <canvas id="gachaCanvas" width="300" height="300"></canvas>
            <div id="rollingOverlay" class="rolling-overlay">
                <div class="rolling-ball"></div>
            </div>
        </div>

        <button onclick="drawCondition()" id="pitchBtn" class="action-btn">
            æŠ•çƒ (PITCH)
        </button>

        <div id="gachaResult" class="result-overlay" onclick="closeGachaResult()">
            <div class="result-content">
                <div class="text-yellow-500 text-lg md:text-xl font-bold tracking-[0.5em] mb-4 animate-pulse">MISSION</div>
                <div id="conditionText" class="result-text leading-tight"></div>
                <div class="text-gray-400 text-sm mt-4">é»æ“Šä»»æ„è™•é—œé–‰</div>
            </div>
        </div>
    </section>

    <!-- é é¢ 2: è€è™æ©Ÿè¨˜åˆ†æ¿ -->
    <section id="theme2" class="page-section">
        <div class="mb-4 text-center">
            <h2 class="text-3xl md:text-4xl serif-title text-white tracking-widest"><span class="text-red-500">TEAM</span> LOTTERY</h2>
            <p class="text-gray-400 text-xs md:text-sm mt-1 font-bold">é»æ“Š SWING é€²è¡Œå°éšŠæŠ½é¸</p>
        </div>

        <div class="scoreboard-container">
            <div class="flex justify-between px-2 mb-2 text-gray-500 text-xs font-mono">
                <span>INNING: 9</span>
                <span>OUT: 2</span>
            </div>
            <div class="scoreboard-screen">
                <div id="slotText" class="slot-text">READY</div>
            </div>
        </div>

        <button onclick="startSlotMachine()" id="swingBtn" class="action-btn bg-red-600 text-white shadow-[0_0_30px_rgba(255,50,50,0.4)]">
            æ®æ£’ (SWING)
        </button>
    </section>

    <!-- é é¢ 3: æ’•å¡åŒ… -->
    <section id="theme3" class="page-section">
        <div class="mb-2 text-center">
            <h2 class="text-3xl md:text-4xl serif-title text-white tracking-widest"><span class="text-purple-400">MVP</span> REVEAL</h2>
            <p class="text-gray-400 text-xs md:text-sm mt-1 font-bold">é»æ“Šå¡åŒ… æ’•é–‹é©šå–œ</p>
        </div>

        <div class="pack-scene" id="packScene" onclick="openPack()">
            
            <!-- å¡ç‰‡å±¤ (éš±è—åœ¨ä¸­é–“) -->
            <div class="player-card">
                <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')]"></div>
                <!-- èª¿æ•´ icon ä½ç½®ä»¥é©æ‡‰å°å¡ç‰‡ -->
                <div class="absolute top-2 left-2 w-7 h-7 md:w-11 md:h-11 rounded-full border-2 border-black flex items-center justify-center">
                    <span class="text-l md:text-l">ğŸ†</span>
                </div>
                <!-- åå­— -->
                <div id="cardName" class="card-name relative z-10"></div>
                <!-- èª¿æ•´åº•éƒ¨æ–‡å­—ä½ç½® -->
                <div class="absolute bottom-2 text-[0.5rem] md:text-xs text-gray-500 font-mono tracking-widest">
                    CCUBaseballï½œ2025ï½œXmas
                </div>
            </div>

            <!-- è¢‹èº« (Bottom) -->
            <div class="pack-body">
                <div class="text-4xl md:text-4xl mb-4">âš¾</div>
                <h3 class="text-xl md:text-xl font-black italic tracking-wider">CCU BASEBALL</h3>
                <p class="mt-4 text-[0.6rem] md:text-xs font-bold border border-gray-600 px-2 py-1 rounded">TAP TO OPEN</p>
            </div>

            <!-- å°å£ (Top) -->
            <div class="pack-cap"></div>

        </div>

        <button onclick="resetPack()" id="resetPackBtn" class="reset-btn">
            å†æŠ½ä¸€æ¬¡ (AGAIN)
        </button>
    </section>

    <script>
        // --- Data (æ›´æ–°å¾Œçš„åå­—) ---
        const conditions = [
            "èº«é«˜æœ€é«˜çš„äºº",
            "èº«é«˜æœ€çŸ®çš„äºº",
            "è¿‘è¦–åº¦æ•¸æœ€æ·±çš„äºº",
            "é‹è™Ÿæœ€å¤§çš„äºº",
            "é ­é«®æœ€é•·çš„äºº",
            "æ‰‹æ©Ÿé›»é‡å‰©ä¸‹æœ€å°‘çš„äºº",
            "LINEæœªè®€è¨Šæ¯æ•¸é‡æœ€å¤šçš„äºº",
            "æ‰‹æ©Ÿæœ€å¾Œä¸€ç¢¼æ•¸å­—æœ€å¤§çš„äºº",
            "ç”Ÿæ—¥é›¢è–èª•ç¯€æœ€è¿‘çš„äºº",
            "åŠ å…¥ã€ŒçƒéšŠè³‡æ­·ã€æœ€æ·ºçš„äºº (éå¹´ç´€)",
            "å¹´é½¡æœ€å¤§çš„äºº",
            "éŒ¢åŒ…è£¡ç¾é‡‘æœ€å°‘çš„äºº",
            "ç©¿çš„è¥ªå­æœ€é•·çš„äºº",
            "IGç²‰çµ²æœ€å°‘çš„äºº",
            "è†šè‰²æœ€é»‘çš„äºº",
            "åå­—ç¸½ç­†ç•«æ•¸æœ€å¤šçš„äºº",
            "é€™å­¸æœŸä¿®èª²å­¸åˆ†æœ€å¤šçš„äºº"
        ];
        const teams = ["ç¬¬ä¸€å°éšŠ", "ç¬¬äºŒå°éšŠ", "ç¬¬ä¸‰å°éšŠ"];
        
        // æ›´æ–°çƒå“¡åå–®
        const names = [
            "å½­ç‘€éœˆ", "æ´ªå³»æ©", "é­å¥ç¥", "å»£æ‰¿ç³", "æˆ´è‚‡éœ†", "è”¡å¿µç‘¾",
            "é»ƒç¿å¦¤", "æ±Ÿç¥å¯¬", "æ²ˆå† ä½‘", "é™³ç’½æ©", "é™³å¯æ™´", "é»ƒéƒå‡±",
            "é»ƒæ…¶æ©", "èŒƒæ°¸ä½³", "é»ƒå†·éŠœ", "åš´è© ç…œ", "æ—ä¸ä½‘", "å´”æ™‰å˜‰", "ææ‰¿æ¾”"
        ];

        function getRandom(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

        // --- Navigation ---
        function switchTab(id) {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-tab${id}`).classList.add('active');
            
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.getElementById(`theme${id}`).classList.add('active');

            if(id === 1) initGacha(); else stopGacha();
        }

        // --- Theme 1: Baseball Gacha (Canvas) ---
        const canvas = document.getElementById('gachaCanvas');
        const ctx = canvas.getContext('2d');
        let balls = [];
        let animId;
        let isRunning = false;
        let speedMultiplier = 1; 
        
        const baseballIcon = new Image();
        baseballIcon.src = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='48' fill='white' stroke='%23999' stroke-width='1'/%3E%3Cpath d='M30 15 Q 55 50 30 85' fill='none' stroke='%23d00' stroke-width='4' stroke-dasharray='5 3' stroke-linecap='round'/%3E%3Cpath d='M70 15 Q 45 50 70 85' fill='none' stroke='%23d00' stroke-width='4' stroke-dasharray='5 3' stroke-linecap='round'/%3E%3C/svg%3E`;

        class Ball {
            constructor() {
                this.r = 20;
                this.x = Math.random() * (canvas.width - this.r*2) + this.r;
                this.y = Math.random() * (canvas.height/2) + this.r;
                this.dx = (Math.random() - 0.5) * 8;
                this.dy = (Math.random() - 0.5) * 8;
                this.angle = 0;
                this.spin = (Math.random() - 0.5) * 0.2;
            }
            update() {
                let effectiveDx = this.dx * speedMultiplier;
                let effectiveDy = this.dy * speedMultiplier;

                if(this.x + this.r + effectiveDx > canvas.width) {
                    this.x = canvas.width - this.r;
                    this.dx = -Math.abs(this.dx);
                } else if (this.x - this.r + effectiveDx < 0) {
                    this.x = this.r;
                    this.dx = Math.abs(this.dx);
                } else {
                    this.x += effectiveDx;
                }

                if(this.y + this.r + effectiveDy > canvas.height) {
                    this.y = canvas.height - this.r;
                    this.dy = -Math.abs(this.dy);
                } else if (this.y - this.r + effectiveDy < 0) {
                    this.y = this.r;
                    this.dy = Math.abs(this.dy);
                } else {
                    this.y += effectiveDy;
                }
                
                if (speedMultiplier === 1) {
                    this.dy += 0.4;
                }
                
                this.angle += this.spin * speedMultiplier;
                
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                ctx.drawImage(baseballIcon, -this.r, -this.r, this.r*2, this.r*2);
                ctx.restore();
            }
        }

        function initGacha() {
            if(isRunning) return;
            const sphere = document.querySelector('.gacha-sphere');
            canvas.width = sphere.clientWidth;
            canvas.height = sphere.clientHeight;
            
            balls = Array.from({length: 12}, () => new Ball());
            isRunning = true;
            loop();
        }
        function stopGacha() { isRunning = false; cancelAnimationFrame(animId); }
        function loop() {
            if(!isRunning) return;
            ctx.clearRect(0,0,canvas.width, canvas.height);
            balls.forEach(b => b.update());
            animId = requestAnimationFrame(loop);
        }

        window.addEventListener('resize', () => {
            if (isRunning) {
               const sphere = document.querySelector('.gacha-sphere');
               canvas.width = sphere.clientWidth;
               canvas.height = sphere.clientHeight;
            }
        });

        function drawCondition() {
            const btn = document.getElementById('pitchBtn');
            const originalText = btn.innerText;
            const rollingOverlay = document.getElementById('rollingOverlay');
            
            btn.innerText = "æŠ•çƒä¸­... (PITCHING)";
            btn.disabled = true;
            
            speedMultiplier = 5;
            rollingOverlay.classList.add('active');

            setTimeout(() => {
                const res = getRandom(conditions);
                document.getElementById('conditionText').innerText = res;
                document.getElementById('gachaResult').classList.add('show');
                
                btn.innerText = originalText;
                btn.disabled = false;
                
                speedMultiplier = 1;
                rollingOverlay.classList.remove('active');
            }, 2000);
        }
        
        function closeGachaResult() {
            document.getElementById('gachaResult').classList.remove('show');
        }

        // --- Theme 2: Slot Machine ---
        let spinning = false;
        function startSlotMachine() {
            if(spinning) return;
            spinning = true;
            
            const txt = document.getElementById('slotText');
            const btn = document.getElementById('swingBtn');
            btn.style.opacity = 0.5;
            txt.classList.add('blur');
            
            let count = 0;
            let speed = 50;
            const max = 60;
            
            function run() {
                txt.innerText = getRandom(teams);
                count++;
                if(count < max) {
                    let delay = speed;
                    if (count > max - 15) {
                        delay += (count - (max - 15)) * 10;
                    }
                    setTimeout(run, delay);
                } else {
                    txt.classList.remove('blur');
                    txt.style.color = '#fff';
                    setTimeout(() => txt.style.color = 'var(--neon-red)', 200);
                    txt.innerText = getRandom(teams);
                    spinning = false;
                    btn.style.opacity = 1;
                }
            }
            run();
        }

        // --- Theme 3: Pack Reveal ---
        let packOpened = false;
        function openPack() {
            if(packOpened) return;
            packOpened = true;
            
            const name = getRandom(names);
            document.getElementById('cardName').innerText = name;
            
            document.getElementById('packScene').classList.add('opened');
            
            setTimeout(() => {
                const btn = document.getElementById('resetPackBtn');
                btn.style.display = 'block';
                setTimeout(() => btn.style.opacity = 1, 50); 
            }, 3500);
        }

        function resetPack() {
            document.getElementById('packScene').classList.remove('opened');
            const btn = document.getElementById('resetPackBtn');
            btn.style.opacity = 0;
            setTimeout(() => {
                btn.style.display = 'none';
            }, 500);
            
            setTimeout(() => {
                document.getElementById('cardName').innerText = ''; 
                packOpened = false;
            }, 600);
        }

        // Init
        window.onload = () => initGacha();

    </script>
</body>
</html>
